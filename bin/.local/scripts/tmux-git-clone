#!/usr/bin/env bash

dst=$(find $HOME/Documents -type d -mindepth 1 -maxdepth 1 | fzf)

if [ -z "$dst" ]; then
    exit 0
fi

read -p "Repository URL: " -r url
repo_name=$(basename $url | cut -d "." -f 1)

if ! tmux has-session -t git-clone &>/dev/null; then
    tmux new-session -d -s git-clone
fi

if [[ ! -d "${dst}/${repo_name}" ]]; then
    tmux send-keys -t git-clone "cd ${dst} && git clone --recursive ${url}" Enter
fi

tmux neww $HOME/.local/scripts/tmux-sessionizer ${dst}/${repo_name}
